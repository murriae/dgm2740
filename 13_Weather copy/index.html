<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="Fill Me In" />
    <meta name="author" content="John Doe" />

    <!-- This start file was build by Paul Cheney  -->
    <title>Weather Information</title>

    <!-- TELLS PHONES NOT TO LIE ABOUT THEIR WIDTH & stops the font from enlarging when a phone is turned sideways-->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
<style >
    body {
        font-family:'Courier New', Courier, monospace;
    }
    .weatherDay {
    border:1px solid gray;
    border-radius: 10px;
    padding: 10px;
    margin-bottom: 20px;
    background-color:lightblue;
    box-shadow: 5px 10px 4px -1px rgba(0,0,0,0.34);
}
.weatherDay img {
    float:right;
}
.weatherDay p {
    margin-top: 5px;
    margin-bottom: 5px;
}
.weatherDay h2,.weatherDay h3 {
    margin-top:5px;
    margin-bottom: 5px;
}

</style>
  </head>
  <body>
    <!-- HEADER HERE -->
      <h1>Weather Information</h1>
    

    <div id="forecast">
      <script>
        let gotPosition = function (pos) {
          let lat = pos.coords.latitude;
          let long = pos.coords.longitude;
          console.log(lat);
          getForecast(lat, long);
        };

        let getForecast = function (lat, long) {
          let url =
            "//api.openweathermap.org/data/2.5/onecall?lat=" + lat + "&lon=" + long + "&exclude=current,minutely,hourly&appid=583f4d9c72b13f531cf6a2b4e843ab69";
            getWeatherText(url);
        };
        async function getWeatherText(url) {
            let weatherObject = await fectch(url);
            let weatherText = await weatherObject.text();
            parseWeather(weatherText);
        }
        let parseWeather = function(weatherText) {
            let weatherJSON = JSON.parse(weatherText);
            let dailyForecast = weatherJSON.daily;
            for (x=0; x < dailyForecast.length; x++) {
                let today = new Date().getDay() + x;
                if (today > 6) {
                    today = today-7;
                }
                let dayOfWeek = getDayOfWeek(today);
                let description = day.weather[0].description;
                let icon = day.weather[0].icon;
                let sunrise = timestampToTime(day.sunrise);
                let sunset = timestampToTime(day.sunset);
                let highTemp= kToF(day.temp.max);
                let lowTemp = kToF(day.temp.min);
                let humidity = day.humidity;
                let windSpeed = day.wind_speed;
                let windGust = day.wind_gust;
                displayWeatherDay(dayOfWeek, description, icon, sunrise, sunset, highTemp, lowTemp, humidity, windSpeed, windGust)
            }
        }
        let displayWeatherDay = function(dayOfWeek, description, icon, sunrise, sunset, highTemp, lowTemp, humidity, windSpeed, windGust) {
            let out = "<div class='weatherDay'><img src='//openweathermap.org/img/wn/" + icon + ".png/>";
                out += "<h2>" + dayOfWeek + "</h2>";
                out += "<h3>" + descirption + "</h3>";
                out += "<p>Sunrise: " + sunrise + "</p>";
                out += "<p>Sunset: " + sunset + "</p>";
                out += "<p>High: " + highTemp + "F</p>";
                out += "<p>Low: " + lowTemp + "F</p>";
                out += "<p>Humidity: " + humidity + "%</p>";
                out += "<p>Wind Speed: " + Math.round(windSpeed) + " with gusts up to " 
                    + Math.round(windGust) + "</p></div>";
                document.getElementById("forecast").innerHTML += out;
        }

        let getDayOfWeek = function(dayNum) {
            var weekday = new Array(7);
            weekday[0] = "Sunday";
            weekday[1] = "Monday";
            weekday[2] = "Tuesday";
            weekday[3] = "Wednesday";
            weekday[4] = "Thursday";
            weekday[5] = "Friday";
            weekday[6] = "Saturday";
        }
      </script>
    </div>
    
  </body>
</html>
